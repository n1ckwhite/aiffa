#  Когда увеличивать мажорную версию в Semver

Увеличивать мажорную версию (MAJOR) в Semantic Versioning (SemVer) следует в тех случаях, когда вносятся изменения, которые делают текущую версию несовместимой с предыдущей. Это сигнал пользователям, что при обновлении они могут столкнуться с необходимостью адаптировать свой код.

---

##  1. Несовместимые изменения в API

###  **Что это означает**

Если публичный API изменился таким образом, что старый код, работающий с предыдущей версией, больше не будет работать.

###  **Примеры изменений**

* Удалён или изменён параметр метода
* Переименован класс, метод или свойство
* Изменён формат данных, возвращаемых функцией
* Изменена сигнатура функции

###  **Пример**

```javascript
// Версия 1.x.x
function processData(data, options) {
  // обработка данных
}

// Версия 2.x.x - MAJOR изменение
function processData(data, config) {  // options → config
  // новая обработка данных
}
```

---

##  2. Удаление функциональности

###  **Что это означает**

Если какая-либо функциональность или метод/класс/функция были удалены.

###  **Примеры удалений**

* Метод `getData()` удалён или заменён на другой
* Класс `OldClass` больше не существует
* Функция `deprecatedFunction()` удалена
* Опция конфигурации `legacyMode` убрана

###  **Пример**

```javascript
// Версия 1.x.x
class DataProcessor {
  getData() { /* ... */ }
  processData() { /* ... */ }
}

// Версия 2.x.x - MAJOR изменение
class DataProcessor {
  // getData() удалён
  processData() { /* ... */ }
  fetchData() { /* ... */ }  // новый метод
}
```

---

##  3. Изменение поведения

###  **Что это означает**

Если существующее поведение функциональности изменилось и это влияет на пользователей.

###  **Примеры изменений поведения**

* Метод, который раньше возвращал `null` при ошибке, теперь выбрасывает исключение
* Функция изменила порядок обработки данных
* Изменилась логика валидации входных данных
* Изменился формат логов или сообщений об ошибках

###  **Пример**

```javascript
// Версия 1.x.x
function validateEmail(email) {
  if (!email) return null;  // возвращает null
}

// Версия 2.x.x - MAJOR изменение
function validateEmail(email) {
  if (!email) throw new Error('Email is required');  // выбрасывает ошибку
}
```

---

##  4. Добавление новых обязательных требований

###  **Что это означает**

Если для работы новой версии стали необходимы новые зависимости, параметры, настройки или требования к окружению.

###  **Примеры требований**

* Приложение больше не поддерживает старую версию языка или платформы
* Добавлены новые обязательные зависимости
* Изменились системные требования
* Требуется новая версия Node.js или другой платформы

###  **Пример**

```json
// Версия 1.x.x
{
  "engines": {
    "node": ">=12.0.0"
  }
}

// Версия 2.x.x - MAJOR изменение
{
  "engines": {
    "node": ">=16.0.0"  // минимальная версия повышена
  }
}
```

---

##  5. Изменения в конфигурации

###  **Что это означает**

Если структура или формат конфигурационных файлов изменился, и старые настройки больше не работают.

###  **Примеры изменений конфигурации**

* Устаревшие ключи конфигурации удалены
* Изменена структура конфигурационного файла
* Переименованы параметры настроек
* Добавлены обязательные поля конфигурации

###  **Пример**

```json
// Версия 1.x.x
{
  "database": {
    "host": "localhost",
    "port": 5432
  }
}

// Версия 2.x.x - MAJOR изменение
{
  "db": {  // database → db
    "connection": {  // новая структура
      "host": "localhost",
      "port": 5432
    }
  }
}
```

---

##  6. Изменение протоколов или интерфейсов

###  **Что это означает**

Если изменились сетевые протоколы, форматы запросов/ответов, или добавлены изменения, нарушающие совместимость в клиент-серверной архитектуре.

###  **Примеры изменений протоколов**

* API версии v1 больше не поддерживается
* Изменён формат HTTP-запросов
* Изменена структура JSON-ответов
* Добавлена обязательная аутентификация

###  **Пример**

```javascript
// Версия 1.x.x - API v1
GET /api/v1/users

// Версия 2.x.x - MAJOR изменение, API v2
GET /api/v2/users
// Требуется новый формат запроса и ответа
```

---

##  7. Существенные изменения, влияющие на пользовательский опыт

###  **Что это означает**

Если приложение или библиотека изменены настолько, что потребуются значительные усилия для адаптации пользователей.

###  **Примеры существенных изменений**

* Полностью переработан пользовательский интерфейс
* Изменена архитектура приложения
* Переписаны основные модули
* Изменён способ взаимодействия с библиотекой

###  **Пример**

```javascript
// Версия 1.x.x
const library = require('my-library');
library.init();
library.doSomething();

// Версия 2.x.x - MAJOR изменение
const { Library } = require('my-library');
const lib = new Library();
lib.initialize();
lib.performAction();
```

---

##  Общие рекомендации

###  **Подготовка к MAJOR версии**

* Увеличение MAJOR версии — это важное событие, которое требует тщательной подготовки
* Необходима ясная документация изменений
* Пользователи должны понимать, что и почему стало несовместимым

###  **Документирование изменений**

* Чётко укажите в релизных заметках все breaking changes
* Предоставьте руководство по миграции
* Объясните причины изменений
* Предложите альтернативы для удалённой функциональности

###  **Стратегия выпуска**

* Рассмотрите возможность поддержки старой версии некоторое время
* Предоставьте инструменты для автоматической миграции
* Создайте подробные примеры использования новой версии

---

##  Итог

| Тип изменения | Пример | Влияние |
|---------------|--------|---------|
| **API изменения** | Удаление параметров | Код перестаёт работать |
| **Удаление функций** | Удаление методов | Требуется рефакторинг |
| **Изменение поведения** | Новые исключения | Неожиданные ошибки |
| **Новые требования** | Повышение версии Node.js | Проблемы совместимости |
| **Конфигурация** | Изменение структуры | Неправильные настройки |
| **Протоколы** | Новый API | Клиенты не работают |
| **Архитектура** | Переписывание модулей | Полная адаптация |

##  ЗАДАЧИ

Задачи по теме `Когда увеличивать мажорную версию в Semver`

---

###  Задача 1: Определить необходимость MAJOR версии

Определите, требуется ли увеличение MAJOR версии: изменён порядок параметров в функции, добавлена новая функция, удалён устаревший метод, исправлен баг, изменена минимальная версия Node.js, добавлен опциональный параметр.

<details>
<summary> Решение</summary>

**Ответ:** Изменение параметров, удаление методов, повышение требований → ДА (MAJOR). Новая функция, исправление бага, опциональный параметр → НЕТ (MINOR/PATCH).

**Объяснение:** MAJOR — изменения, ломающие совместимость. MINOR — новые функции. PATCH — исправления.

</details>

---

###  Задача 2: Планирование MAJOR релиза

Какие шаги предпринять для успешного MAJOR релиза: документы, уведомления, инструменты миграции, поддержка старой версии?

<details>
<summary> Решение</summary>

**Ответ:** Релизные заметки, руководство миграции, анонсы за несколько месяцев, скрипты миграции, поддержка 6-12 месяцев.

**Объяснение:** Тщательная подготовка и инструменты снижают риски для пользователей.

</details>

---

 Правильное определение необходимости увеличения MAJOR версии помогает пользователям подготовиться к изменениям и минимизирует риски при обновлении.

---
