#  HTTP 404 Not Found: теория, причины и обработка

Код состояния HTTP, который соответствует ошибке "Not Found", — это **404**. Этот код указывает на то, что сервер не может найти запрашиваемый ресурс. Это может происходить из-за неверного URL или того, что ресурс был удален или перемещен.

---

##  Что означает 404 Not Found

### Основное назначение
- **Описание**: Сервер получил запрос, но не может найти запрашиваемый ресурс.
- **Категория**: Ошибка клиента (4xx).
- **Семантика**: Ресурс не существует по указанному URI.

### Типичные причины возникновения
1. **Неверный URL**: Опечатка в адресе, неправильный путь.
2. **Удалённый ресурс**: Файл или страница были удалены с сервера.
3. **Перемещённый ресурс**: Ресурс существует, но по другому адресу.
4. **Неправильная конфигурация**: Проблемы с настройкой сервера.
5. **API-эндпоинт не существует**: Запрос к несуществующему API.

---

##  Примеры сценариев 404

###  Пример 1: Неверный URL
```javascript
// Попытка получить пользователя с несуществующим ID
fetch('/api/users/999999')
  .then(response => {
    if (response.status === 404) {
      console.error('Пользователь не найден');
      showErrorMessage('Пользователь не существует');
    }
  });
```

###  Пример 2: Несуществующая страница
```javascript
// Запрос к несуществующей странице
fetch('/pages/non-existent-page.html')
  .then(response => {
    if (response.status === 404) {
      // Перенаправить на страницу 404
      window.location.href = '/404.html';
    }
  });
```

###  Пример 3: API-эндпоинт не найден
```javascript
// Запрос к несуществующему API
fetch('/api/non-existent-endpoint')
  .then(response => {
    if (response.status === 404) {
      console.error('API endpoint не найден');
      // Показать пользователю понятное сообщение
      showApiError('Запрашиваемый сервис недоступен');
    }
  });
```

---

##  Обработка 404 в JavaScript

###  Универсальная обработка
```javascript
async function fetchResource(url) {
  try {
    const response = await fetch(url);
    
    if (response.status === 404) {
      throw new Error('Ресурс не найден');
    }
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
    }
    
    return await response.json();
  } catch (error) {
    console.error('Ошибка при загрузке:', error.message);
    
    if (error.message === 'Ресурс не найден') {
      // Специальная обработка для 404
      show404Page();
    } else {
      // Общая обработка других ошибок
      showErrorMessage('Произошла ошибка при загрузке данных');
    }
  }
}
```

###  Обработка с retry-логикой
```javascript
async function fetchWithRetry(url, maxRetries = 3) {
  for (let i = 0; i < maxRetries; i++) {
    try {
      const response = await fetch(url);
      
      if (response.status === 404) {
        // Для 404 не имеет смысла повторять запрос
        throw new Error('404 Not Found');
      }
      
      if (!response.ok) {
        throw new Error(`HTTP ${response.status}`);
      }
      
      return await response.json();
    } catch (error) {
      if (error.message === '404 Not Found' || i === maxRetries - 1) {
        throw error;
      }
      // Ждём перед повторной попыткой
      await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1)));
    }
  }
}
```

---

##  Сравнение 404 с другими ошибками

| Код | Название | Описание | Отличие от 404 |
|-----|----------|----------|----------------|
| 400 | Bad Request | Неверный синтаксис запроса | Запрос некорректен |
| 401 | Unauthorized | Требуется авторизация | Нужно войти в систему |
| 403 | Forbidden | Доступ запрещён | Есть права, но доступ закрыт |
| **404** | **Not Found** | **Ресурс не существует** | **Ресурса нет вообще** |
| 500 | Internal Server Error | Ошибка сервера | Проблема на стороне сервера |

---

##  Лучшие практики обработки 404

### На стороне клиента
- Показывайте понятные сообщения пользователю.
- Предлагайте альтернативные действия (поиск, навигация).
- Логируйте 404-ошибки для анализа.
- Не повторяйте запросы при 404 (бессмысленно).

### На стороне сервера
- Возвращайте правильный статус-код 404.
- Предоставляйте полезную информацию в ответе.
- Настройте кастомные страницы 404.
- Логируйте 404-запросы для анализа.

###  Пример кастомной страницы 404
```html
<!DOCTYPE html>
<html>
<head>
    <title>Страница не найдена</title>
</head>
<body>
    <h1>404 - Страница не найдена</h1>
    <p>К сожалению, запрашиваемая страница не существует.</p>
    <a href="/">Вернуться на главную</a>
    <a href="/search">Поиск</a>
</body>
</html>
```

---

##  Итог

- **404 Not Found** — ресурс не существует по указанному URI.
- Правильная обработка 404 улучшает пользовательский опыт.
- Не повторяйте запросы при 404 (бессмысленно).
- Логируйте и анализируйте 404-ошибки для улучшения сайта.

##  ЗАДАЧИ

Задачи по теме `HTTP 404 Not Found`:

---

###  Задача 1: Определи причину
Какая из перечисленных причин НЕ может вызвать ошибку 404?
1. Неверный URL
2. Отсутствие авторизации
3. Удалённый ресурс
4. Опечатка в пути
<details>
<summary> Решение</summary>

**Ответ:**
2. Отсутствие авторизации — это 401 Unauthorized, а не 404 Not Found.

</details>

---

###  Задача 2: Обработка 404
Напишите код для обработки 404-ошибки в fetch-запросе:
<details>
<summary> Решение</summary>

```javascript
fetch('/api/users/123')
  .then(response => {
    if (response.status === 404) {
      console.error('Пользователь не найден');
      showErrorMessage('Пользователь не существует');
    } else if (!response.ok) {
      throw new Error(`HTTP ${response.status}`);
    }
    return response.json();
  })
  .catch(error => {
    console.error('Ошибка:', error);
  });
```

</details>

---

###  Задача 3: Retry логика
Почему не имеет смысла повторять запрос при получении 404?
<details>
<summary> Решение</summary>

**Ответ:**
404 означает, что ресурс не существует. Повторные запросы не изменят этот факт — ресурс так и останется несуществующим.

</details>

---

###  Задача 4: Разница с 403
В чём разница между ошибками 403 Forbidden и 404 Not Found?
<details>
<summary> Решение</summary>

**Ответ:**
403 — ресурс существует, но у пользователя нет прав доступа к нему.
404 — ресурс не существует вообще.

</details>

---

###  Задача 5: Анализ логов
Что можно узнать из анализа 404-ошибок на сайте?
<details>
<summary> Решение</summary>

**Ответ:**
- Популярные несуществующие URL
- Опечатки пользователей в адресах
- Устаревшие ссылки на сайте
- Проблемы с навигацией
- Попытки доступа к удалённым ресурсам

</details>

---

 Эти задачи помогут понять природу ошибки 404 и правильно её обрабатывать в веб-приложениях! 